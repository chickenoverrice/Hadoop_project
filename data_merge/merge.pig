walk = load 'walk.csv' using PigStorage(',');
school = load 'school.csv' using PigStorage(',');
crime = load 'crime.csv' using PigStorage(',');
zillow = load 'zillow_new' using PigStorage(',');
phila = load 'philaSelected' using PigStorage(',');
merge1 = JOIN walk BY $0, school BY $0;
rmdup1 = foreach merge1 generate $0, $1, $3;
merge2 = join rmdup1 by $0, crime by $0;
rmdup2 = foreach merge2 generate $0, $1, $2, $4, $5, $6;
merge3 = join zillow by $0, phila by $0;
rmdup3 = foreach merge3 generate $0,$1,$2,$3,$4,$5,$6,$7, $8,$9,$10,$11,$12, $13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$24,$25; 
merge4 = join rmdup3 by $3, rmdup2 by $0;
rmdup4 = foreach merge4 generate $0,$1,$2,$3,$4,$5,$6,$7, $8,$9,$10,$11,$12, $13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24, $26, $27, $28, $29, $30;
rmdup5 = distinct rmdup4;
clean1 = filter rmdup5 by ($3 is not null);
clean2 = filter clean1 by ($24 is not null);
store clean2 into 'Merged' using PigStorage(',');
